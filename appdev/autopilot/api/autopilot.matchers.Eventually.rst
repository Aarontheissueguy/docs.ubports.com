autopilot.matchers.Eventually
=============================

.. raw:: html

   <dl class="class">

.. raw:: html

   <dt id="autopilot.matchers.Eventually">

class autopilot.matchers.Eventually(matcher, \*\*kwargs)

.. raw:: html

   </dt>

.. raw:: html

   <dd>

.. raw:: html

   <p>

Asserts that a value will eventually equal a given Matcher object.

.. raw:: html

   </p>

.. raw:: html

   <p>

This matcher wraps another testtools matcher object. It makes that other
matcher work with a timeout. This is necessary for several reasons:

.. raw:: html

   </p>

.. raw:: html

   <ol class="arabic simple">

.. raw:: html

   <li>

Since most actions in a GUI applicaton take some time to complete, the
test may need to wait for the application to enter the expected state.

.. raw:: html

   </li>

.. raw:: html

   <li>

Since the test is running in a separate process to the application under
test, test authors cannot make any assumptions about when the
application under test will recieve CPU time to update to the expected
state.

.. raw:: html

   </li>

.. raw:: html

   </ol>

.. raw:: html

   <p>

There are two main ways of using the Eventually matcher:

.. raw:: html

   </p>

.. raw:: html

   <p>

Attributes from the application:

.. raw:: html

   </p>

.. raw:: html

   <pre><span class="bp">self</span><span class="o">.</span><span class="n">assertThat</span><span class="p">(</span><span class="n">window</span><span class="o">.</span><span class="n">maximized</span><span class="p">,</span> <span class="n">Eventually</span><span class="p">(</span><span class="n">Equals</span><span class="p">(</span><span class="bp">True</span><span class="p">)))</span>
   </pre>

.. raw:: html

   <p>

Here, window is an object generated by autopilot from the applications
state. This pattern of usage will cover 90% (or more) of the assertions
in an autopilot test. Note that any matcher can be used - either from
testtools or any custom matcher that implements the matcher API:

.. raw:: html

   </p>

.. raw:: html

   <pre><span class="bp">self</span><span class="o">.</span><span class="n">assertThat</span><span class="p">(</span><span class="n">window</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">Eventually</span><span class="p">(</span><span class="n">GreaterThan</span><span class="p">(</span><span class="mi">200</span><span class="p">)))</span>
   </pre>

.. raw:: html

   <p>

Callable Objects:

.. raw:: html

   </p>

.. raw:: html

   <pre><span class="bp">self</span><span class="o">.</span><span class="n">assertThat</span><span class="p">(</span>
   <span class="n">autopilot</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">Eventually</span><span class="p">(</span><span class="n">Equals</span><span class="p">(</span><span class="s">&quot;Galaxy Nexus&quot;</span><span class="p">)))</span>
   </pre>

.. raw:: html

   <p>

In this example we’re using the autopilot.platform.model function as a
callable. In this form, Eventually matches against the return value of
the callable.

.. raw:: html

   </p>

.. raw:: html

   <p>

This can also be used to use a regular python property inside an
Eventually matcher:

.. raw:: html

   </p>

.. raw:: html

   <pre><span class="bp">self</span><span class="o">.</span><span class="n">assertThat</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">Eventually</span><span class="p">(</span><span class="n">LessThan</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
   </pre>

.. raw:: html

   <p class="first admonition-title">

Note

.. raw:: html

   </p>

.. raw:: html

   <p class="last">

Using this form generally makes your tests less readable, and should be
used with great care. It also relies the test author to have knowledge
about the implementation of the object being matched against. In this
example, if self.mouse.x were ever to change to be a regular python
attribute, this test would likely break.

.. raw:: html

   </p>

.. raw:: html

   <p>

Timeout

.. raw:: html

   </p>

.. raw:: html

   <p>

By default timeout period is ten seconds. This can be altered by passing
the timeout keyword:

.. raw:: html

   </p>

.. raw:: html

   <pre><span class="bp">self</span><span class="o">.</span><span class="n">assertThat</span><span class="p">(</span><span class="n">foo</span><span class="o">.</span><span class="n">bar</span><span class="p">,</span> <span class="n">Eventually</span><span class="p">(</span><span class="n">Equals</span><span class="p">(</span><span class="mi">123</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
   </pre>

.. raw:: html

   <p class="first admonition-title">

Warning

.. raw:: html

   </p>

.. raw:: html

   <p class="last">

The Eventually matcher does not work with any other matcher that expects
a callable argument (such as testtools’ ‘Raises’ matcher)

.. raw:: html

   </p>

.. raw:: html

   </dd>

.. raw:: html

   </dl>
